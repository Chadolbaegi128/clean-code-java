# Comment

> 나쁜 코드에 주석을 달지 마라. 새로 짜라.

잘 달린 주석은 어떤 정보보다 유용하지만, 경솔한 주서거은 코드에 거짓과 잘못된 정보를 퍼뜨려 부작용을 초래한다. 코드 자체를 치밀하게 작성해 의도를 표현할 수 있다면, 주석은 필요하지 않다.

주석은 오래될수록 코드에서 멀어진다. 주석을 엄격하게 관리하고 복구성과 관련성, 정확성을 높이는 것이 방법일 수도 있지만, 코드를 깔끔하게 정리하고 표현력을 강화하는 쪽이 더 효과적이다.

부정확한 주석은 없는 것보다 훨씬 못하다. 부정확한 주석은 읽는 사람으로 하여금 현혹하고 오도한다. 더 이상 지킬 필요가 없는 규칙이나 지켜서는 안되는 규칙을 명시한다. 따라서 최대한 주석을 줄이도록 노력하자.

이번 섹션에서는 **주석을 줄여야하는 이유와 그럼에도 사용할 수 있는 좋은 주석, 나쁜 주석의 예시**를 다룬다. 

## 목차
1. [주석은 나쁜 코드를 보완하지 못한다.](#보완)
2. [코드로 의도를 표현하라.](#의도)
3. [좋은 주석](#좋은주석)
4. [나쁜 주석](#나쁜주석)

## <div id="보완">주석은 나쁜 코드를 보완하지 못한다.</div>
코드에 주석을 추가하는 이유는 코드만으로 의도를 제대로 표현하지 못하기 때문이다. (== 짜고 보니 짜임새도 엉망이고 알아먹기 힘들다..)

그렇다고 해서 주석을 추가해 설명하려하면 안된다. 주석으로 설명하기보단 코드를 깔끔하게 다듬는 데 시간을 써야한다. 표현력이 풍부하고 깔끔하며 주석이 거의 없는 코드가, 복잡하고 어수선한 주석이 달린 코드보다 훨씬 좋다.
<br>
<br>

## <div id="의도">코드로 의도를 표현하라.</div>
코드만으로 의도를 설명하기 어려운 경우가 존재하긴 한다. 그렇다고 해도, 코드로 최대한 표현하려고 노력해야 한다.

**Bad:**
```java
//직원에게 복지 해택을 받을 자격이 있는지 검사한다.
if((employee.flags & HOULRY_FLAG) && (employee.age > 65))
        ...
```

**Good:**
```java
if(employee.isEligibleForFullBenefits())
```

두 코드를 비교하면 명확하게 아래처럼 주석 없이도 표현할 수 있음을 알 수 있다. 대부분은 주석의 설명을 함수로 축약해 만들어 표현하면 충분히 의도가 드러난다.
<br>
<br>

## <div id="좋은주석">좋은 주석</div>

그럼에도 불구하고 특정 주석들은 유익하다. 몇 가지 예시를 소개한다. 하지만 가장 좋은 것은 늘 주석을 달지 않는 방법을 생각하는 것이다.

### 법적인 주석
저작권, 소유권 등 법적인 이유로 회사가 정립한 구현 표준에 따라야 하는 경우. 모든 계약 조건을 명시하는 것이 아니라 표준 라이센스나 외부 문서에 대한 참조만 추가하는 것으로 충분하다.

**Example:**
```java
//Copyright (C) 2003,2004,2005 by Object Mentor, Inc. All rights reserved.
//GNU General Public License 버전 2 이상을 따르는 조건으로 배포한다.
```

다음과 같은 법적 정보를 코드 첫머리에 추가하는 형식이 일반적이며, 요즘의 IDE들은 이런 헤더를 자동으로 축소해 코드만 깔끔하게 표시해주기도 한다. 

### 정보를 제공하는 주석
기본적인 정보를 주석으로 제공하기도 한다. 그러나 이는 정말 꼭 필요한지, 코드로 표현할 수는 없는지 확인해야 한다.

**Bad:**
```java
//테스트 중인 Responder 인스턴스를 반환한다.
protected abstract Responder responderInstance();
```

위 코드의 주석이 유용하다할지라도, 함수 이름을 아래처럼 바꾼다면 주석이 필요 없어진다.

**Good:**
```java
protected abstract Responder responderBeingTested();
```

특히 날짜와 같은 형식은 주석으로 나타내도 무방하다. 하지만, 시각과 날짜를 변환해주는 클래스를 제작해서 변환해준다면, 더 깔끔하고 주석도 필요 없어진다.

### 의도를 설명하는 주석
때로 주석은 구현의 이해를 돕는 수준에서 벗어나 제작 과정 아래 깔린 의도까지 설명해준다. 

**Bad:**
```java
public int compareTo(Object o) {
    if(o instanceof WikiPagePah) {
        WikiPagePath p = (WikiPagePath) o;
        String compressedName = StringUtil.join(names, "");
        String compressedArgumentName = StringUtil.join(p.names, "");
        return compressedName.compareTo(compressedArgumentName);
        }
    return 1; // 옳은 유형이르모 정렬 순위가 더 높다.
}
```

위 코드는 두 객체를 비교할 때 어떤 객체보다 자기 객체에 높은 우선 순위를 주기로 했음을 주석으로 표현했다. 위 코드는 아래와 같이 수정하면, 주석 없이 의도를 표현할 수 있다.

```java
public void testConcurrentAddWidgets() throws Exception {
    WidgetBuilder widgetBuilder = new WidgetBuilder(new Class[]{BoldWidget.class});
    String text = "'''bold text'''";
    ParentWidget parent = new BoldWidget(new MockWidgetRoot(), "'''bold text'''");
    AtomicBoolean failFlag = new AtomicBoolean();
    failFlag.set(false);
    
    //스레드를 대량 생성하는 방법으로 어떻게든 경쟁 조건을 만들려 시도한다.
    for (int i = 0; i < 25000; i++) {
        WidgetBuilderThread widgetBuilderThread = new WidgetBuilderThread(widgetBuilder, text, parent, failFlag);
        Thread thread = new Thread(widgetBuilderThread);
        thread.start();
        }
    assertEquals(false, failFlag.get());
}
```

반면 위 코드는 저자가 문제를 해결한 방식과 달라지긴 했지만, 주석을 사용하지 않고도 저자의 의도는 분명히 드러냈다. (중간에 있는 주석은 독자들에게 설명하기 위한 주석, 저런 식으로 구현하면 된다고 말하고 싶은 듯)

### 의미를 명료하게 밝히는 주석

모호한 파라미터나 반환값의 의미를 표현하기 위해서 사용하는 주석은 괜찮다. 일반적으로 파라미터나 반환값 자체를 명확하게 만들면 더 좋지만, 표준 라이브러리나 변경하지 못하는 코드에 속하는 경우 의미를 명료하게 밝히는 주석은 효과적이다.

```java
assertTure(a.compareTO(a) == 0); // a == a
```

위 주석은 표준 라이브러리의 함수 compareTo의 의미를 명료하게 밝히는 용도로 사용한다. 반면 이런 주석이 올바른지 검증하는 것은 쉽지 않기 때문에, 의미를 명료히 밝히는 주석은 더 위험할 수도 있다.

### 결과를 경고하는 주석

다른 프로그래머들에게 결과를 경고하는 목적으로 사용하는 주석도 존재한다.

```java
public static SimpleDateFormat makeStandardHttpDateFormat(){
    // SimpleDateFormat은 스레드에 안전하지 못하다.
    // 따라서 각 인스턴스를 독립적으로 생성해야 한다.
    SimpleDataFormat df = new SimpleDataFormat("EEE, dd MMM yyyy HH:mm:ss z");
    df.setTimeZone(TimeZone.getTimeZone("GMT"));
    return df;
}
```

**테스트 코드의 경우 오래 걸리거나 결과가 위험할 수 있는 테스트 케이스에 대해서 @Ignore annotation을 추가하고, @Ignore("실행이 너무 오래 걸림") 등으로 설명을 추가하는 방식으로 미리 경고와 함께 테스트케이스를 끌 수 있다.**

### TODO 주석

앞으로 할 일을 '//TODO:' 의 형태로 남겨두면 나중에 찾기도 편하다. 현대적인 IDE들은 TODO 주석들을 Highlight 할 수 있는 플러그인을 제공하기도 한다.

TODO 주석은 필요하다고 생각되지만, 당장 구현하기는 어려운 임무를 기술한다. 혹은 필요 없는 기능을 검토 후 삭제해달라는 기록, 코드 리뷰 요청, 더 좋은 이름을 요구하는 부탁, 앞으로의 변화에 맞게 코드를 수정하라는 주의 등의 용도로 사용하면 효과적이다.

반면 시스템에 나쁜 코드를 남겨두는 용도로 사용되거나, 너무 많은 TODO 를 남발하는 것은 좋지 않다. 주기적으로 TODO를 점검해 제거해주도록 하자.

```java
//TODO: Admin module 구현 완료시 생성한 사용자 기록하기
```

### 중요성을 강조하는 주석

자칫 대수롭지 않다고 여겨질 뭔가의 중요성을 강조하기 위해서 주석을 사용하자. 반면 해당 주석도 너무 많이 남발되는 경우 프로그래머로 하여금 해당 주의를 무시해버리도록 만들 수 있으니 꼭 필요한 경우에만 사용하자.

```java
String listItemContent = match.group(3).trim();
// 여기서 trim은 정말 중요하다. trim 함수는 문자열에서 시작 공백을 제거한다.
// 문자열에 시작 공백이 있으면 다른 문자열로 인식된다.
new ListItemWidget(this, listItemContent, this.level + 1);
return buildList(text.substring(match.end()));
```

### 공개 API에서 Javadocs

설명이 잘된 API는 사용자에게 유용하다. 공개 API를 구현한다면 반드시 잘 고려한 Javadocs를 추가해야 한다. 반면, 해당 주석을 추가할 때도 본 장에서 언급한 내용들은 명심하면서 추가하자. Javadocs 또한 독자를 오도하거나, 잘못 위치하거나, 그릇된 정보를 전달해 현혹시킬 가능성이 있다. 


## <div id="나쁜주석">나쁜 주석</div>

